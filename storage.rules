rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // 開発環境用: 全てのアクセスを許可
    // 本番環境では必ず適切な認証ルールに変更してください
    match /{allPaths=**} {
      allow read: if true;
      allow write: if true;
    }
    
    // ブログ画像関連のルール（将来の本番環境用）
    match /blog/thumbnails/{postId}/{fileName} {
      // 誰でも読み取り可能
      allow read: if true;
      // 管理者のみアップロード・削除可能
      allow write: if request.auth != null && request.auth.token.admin == true;
      
      // ファイルサイズ制限 (5MB)
      allow write: if request.resource.size < 5 * 1024 * 1024;
      
      // 画像ファイルのみ許可
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    match /blog/thumbnails/temp/{fileName} {
      // 誰でも読み取り可能
      allow read: if true;
      // 認証済みユーザーのみアップロード可能（一時保存）
      allow write: if request.auth != null;
      
      // ファイルサイズ制限 (5MB)
      allow write: if request.resource.size < 5 * 1024 * 1024;
      
      // 画像ファイルのみ許可
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    match /blog/content/{postId}/{fileName} {
      // 誰でも読み取り可能
      allow read: if true;
      // 管理者のみアップロード・削除可能
      allow write: if request.auth != null && request.auth.token.admin == true;
      
      // ファイルサイズ制限 (5MB)
      allow write: if request.resource.size < 5 * 1024 * 1024;
      
      // 画像ファイルのみ許可
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    match /blog/content/temp/{fileName} {
      // 誰でも読み取り可能
      allow read: if true;
      // 認証済みユーザーのみアップロード可能（一時保存）
      allow write: if request.auth != null;
      
      // ファイルサイズ制限 (5MB)
      allow write: if request.resource.size < 5 * 1024 * 1024;
      
      // 画像ファイルのみ許可
      allow write: if request.resource.contentType.matches('image/.*');
    }
  }
}

